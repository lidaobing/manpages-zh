. mso zh.tmac
.\"Generated by db2man.xsl. Don't modify this, modify the source.
.de Sh \" Subsection
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Ip \" List item
.br
.ie \\n(.$>=3 .ne \\$3
.el .ne 3
.IP "\\$1" \\$2
..
.TH "SMBPASSWD" 5 "" "" ""
.SH NAME
smbpasswd \- Samba加密的口令文件。 
.SH "总览 SYNOPSIS"

.PP
\fIsmbpasswd\fR

.SH "描述 DESCRIPTION"

.PP
此文件是 \fBSamba\fR(7) 套件的一部分。 

.PP
smbpasswd是Samba加密的口令文件。文件中包含了用户名，UNIX用户ID和SMB用户口
令(经过hash散列算法处理过)，还有账号标志信息及上次更改口令时间。samba已经
改进了文件格式并和以前的格式有些不同之处。

.SH "文件格式 FILE FORMAT"

.PP
Samba 2.2使用的smbpasswd文件格式和UNIX的\fIpasswd(5)\fR文件非常类似。它是个ASCII文件，其中每行内容对应一个用户。每个字段用冒号分隔。任何以#号开始的行将被忽略。对于每个用户在smbpasswd文件中都包含以下的信息： 

.TP
name
用户名，必须是标准UNIX口令文件中已经存在的用户名。 

.TP
uid
UNIX的用户标识。必须匹配标准UNIX口令文件中相应用户的UID字段。如果不匹配Samba会拒绝确认用户的整个描述项合法。

.TP
Lanman Password Hash
此处是用户口令的32位十六进制编码的LANMAN散列表。LANMAN散列表是用DES加密过
的用户口令字串。这也是Windows 95/98使用的口令。注意这份口令编码表在字典攻
击法下非常脆弱，并且如果两个用户使用了相同的口令的话，这个口令散列表将会
相同(也就是这个口令没有像UNIX口令那样\(lq加工\(rq过)。如果用户使用了空口
令，这个部分起始将是\(lqNO PASSWORD\(rq的十六进制字串。而如果这些十六进制
字串是32个\(lqX\(rq的话，那么这个用户账号就被\fB禁止\fR了，用户就不能登录
到samba服务器上了。

\fB警告\fR！！注意到由于SMB/CIFS验证协议的\(lq请求-响应\(rq特性，任何了解
口令散列表信息的人都可以伪装成网络中的其他用户。因此，这些口令散列表信息
都相当于只是\(lq明文\(rq一样(\fBplain text equivalents\fR). root以外的任
何用户都不应该获得这些数据. 为了保护这些口令，smbpasswd文件被存放到只有
root用户可以读取和访问的目录中，而smbpasswd文件本身也必须设成只有root用户
可以读/写，而其它人无法访问。

.TP
NT Password Hash
指定Windows NT的用户口令散列表，也是32位的十六进制编码。NT的散列表用16位
的用户口令，little-endian UNICODE编码建立，然后用MD4算法(互联网草案
rfc1321)产生对应的散列表。

这种口令散列表比Lanman Password Hash更安全，因为它用更高质量的散列算法来
维护口令和用户信息。但是它仍然存在当两个用户使用相同口令时口令项相同的问
题(没有像UNIX口令那样\(lq加工\(rq过)。

\fB警告\fR！！注意到由于SMB/CIFS验证协议的\(lq请求-响应\(rq特性，任何了解
口令散列表信息的人都可以伪装成网络中的其他用户。因此，这些口令散列表信息
都相当于只是\(lq明文\(rq一样(\fBplain text equivalents\fR). root以外的任
何用户都不应该获得这些数据. 为了保护这些口令，smbpasswd文件被存放到只有
root用户可以读取和访问的目录中，而smbpasswd文件本身也必须设成只有root用户
可以读/写，而其它人无法访问。

.TP
Account Flags

账号标志部分描述了用户账号的属性。在Samba 2.2中这个字段是用`['和`]'字符封
闭的。它的长度总是13个字符(包含`['和`]'字符), 内容可以是如下的任何字符。

\fBU\fR - 说明这是一个\(lq用户\(rq 账号，也就是原始用户。在smbpasswd文件中只支持用户和工作站信任账号。

\fBN\fR - 说明这个账号没有口令(Lanman Password Hash和NT Password Hash字段会被忽略)。注意只有在\fBsmb.conf\fR(5)配置文件中设定了\fI null passwords\fR，才允许用户不带口令进行登录。

\fBD\fR - 说明此账号被禁止了，此用户无法登录SMB/CIFS。 

\fBW\fR - 说明此账号是个 \(lq工作站信任\(rq 账号。这类账号被用在把samba作为PDC时, NT工作站和服务器加入到域中的时候。

其它标志作为将来功能扩展所用。这个标志字段余下的空间用空格填充。 

.TP
Last Change Time
这个字段由账号最后修改的时间组成。它以字符LCT(含义是\(lqLast Change
Time\(rq)后跟UNIX以秒计的时间编码数字(从epoch(公元1970年)开始计算)。

.PP
所有其余用冒号分隔的字段现在都将被忽略。

.SH "版本 VERSION"

.PP
此手册页是针对samba套件版本3.0的。

.SH "参见 SEE ALSO"

.PP
\fBsmbpasswd\fR(8), \fBSamba\fR(7), 以及互联网草案RFC1321 中MD4算法的详细资料。

.SH "作者 AUTHOR"

.PP
samba软件和相关工具最初由Andrew Tridgell创建。samba现在由Samba Team 作为开源软件来发展，类似linux内核的开发方式。

.PP
最初的samba手册页是 Karl Auer写的。
手册页源码已经转换为YODL格式(另一种很好的开源软件，可以在ftp://ftp.ice.rug.nl/pub/unix找到)，由Jeremy Sllison 更新到Samba2.0 版本。
Gerald Carter 在Samba2.2中将它转化为DocBook 格式。
Alexander Bokovoy 在Samba 3.0中实现了DocBook XML4.2 格式的转换。

.SH "[中文版维护人]"
.B meaculpa <meaculpa@21cn.com>
.SH "[中文版最新更新]"
.B 2000/12/08
.SH "《中国linux论坛man手册页翻译计划》:"
.BI http://cmpp.linuxforum.net 
